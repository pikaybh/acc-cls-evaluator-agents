user_query_v3 = """
당신의 목표는 주어진 건설현장 내용을 검토하여, 관련된 인적 사고 유형을 분류하는 것이야.
아래 제공된 내용을 확인하고 발생 가능성 있거나 직접·간접적으로 연관된 사고 유형을 모두 골라줘.
건설 현장 작업내용 중 '유해위험요인'을 중심으로 보고 감소대책 공정, 설비, 물질은 참고용으로 고려해.

사고 유형 선택 기준은 반드시 아래의 상세 지침을 따라:
- '사람에게 일어난 결과'를 중심으로 사고 유형을 선택해.
- '떨어짐'은 사람이 낙하한 경우에 분류해.
- 자재 등 사물이 낙하하거나 부딪혀 사람에게 충격을 준 경우, '충돌 및 접촉'으로 분류.
- 현장 내 장비, 차량, 지게차, 크레인 등과 충돌한 경우에도 '충돌 및 접촉'으로 분류.
- 협착, 감김 등 신체의 일부가 끼이거나 감긴 경우는 '끼임'으로 분류.
- 신체가 절단, 베임, 찔림을 입은 경우는 '절상(절단,찔림,베임)'으로 분류.
- 폭발로 인한 부상은 '화상'으로 분류해.
- 분진으로 인한 호흡기 질환은 '질병'으로 분류.
- 어떠한 사고 유형도 명확히 드러나지 않는 경우, '기타'로 분류.

사고 유형은 반드시 아래 리스트에서만 선택해야 합니다. 
이전 분류 결과와 피드백이 주어진 경우, 그 내용을 참고하여 더 정확하게 개선된 사고 유형 목록을 작성하세요.

- 감전
- 기타
- 깔림
- 끼임
- 넘어짐
- 떨어짐
- 충돌 및 접촉
- 절상(절단,찔림,베임)
- 질병
- 질식
- 화상

해당될 수 있는 모든 사고 유형을 한글로, 세미콜론으로 구분하여 출력하세요.

건설 현장 작업내용:
{}
"""

evaluator_prompt_v3 = """
다음 사고 유형 분류 결과를 평가하십시오:

## 평가기준
1. 보고서에서 명시적으로 언급되거나, 합리적으로 추론 가능한 모든 사고 유형이 포함되어 있는가?
   - 직접적으로 언급된 사고 유형은 반드시 포함해야 합니다.
   - 명시적으로 드러나지 않더라도, 보고서의 내용상 논리적으로 충분히 연관성이 인정된다면 포함할 수 있습니다.
   - 근거 없이 포함된 유형은 감점 대상입니다.

2. 사고 유형 선정의 정확성 및 일관성 (아래 지침 준수 여부 확인)
   - 사고의 **결과(사람에게 일어난 피해)**를 중심으로 유형을 분류했는가?
   - 아래 지침이 올바르게 적용되었는지 확인:
     - 사람이 낙하한 경우만 ‘떨어짐’
     - 자재·공구·장비 등이 사람에게 충격을 준 경우 ‘충돌 및 접촉’
     - 장비·차량·크레인과의 충돌도 ‘충돌 및 접촉’
     - 협착·감김은 ‘끼임’
     - 베임·찔림·절단은 ‘절상(절단,찔림,베임)’
     - 폭발로 인한 부상은 ‘화상’
     - 호흡기 질환 유발 분진 등은 ‘질병’
     - 명확히 유형이 드러나지 않는 경우만 ‘기타

3. 포괄성 및 누락 여부
   - 사고 유형이 지나치게 누락되어, 현장의 실제 위험성이 과소평가된 경우 감점입니다.
   - 중요한 사고 유형이 빠졌다면, 반드시 어떤 내용 때문에 추가되어야 하는지 근거를 명시하세요.

4. 표현 및 포맷
   - 사고 유형은 반드시 한글로, 세미콜론(;)으로 구분되어야 합니다.
   - 리스트에 없는 임의의 유형은 포함시키지 마세요.

## 평가결과 응답예시
- 모든 기준이 충족되었으면 "평가결과 = PASS"를 출력하세요.
- 문제점이 있다면, 구체적으로 어떤 사고 유형이 잘못 포함되었거나 누락되었는지 지적하고, 반드시 개선 방향을 제시하세요.
- 주요 기준을 충족하지 못한 경우 "평가결과 = FAIL"을 출력하고, 반드시 핵심적인 문제점을 설명하세요.

사고 유형 분류 결과:
"""